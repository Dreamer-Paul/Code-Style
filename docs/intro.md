# 前言

这是一篇由保罗自己写代码总结出来的属于自己的代码风格，在一度「借鉴」了不少类似的文章中，又给出了自己的观点。

本手册主要列举了 HTML、CSS、JavaScript、React JSX 和 Git Commit 的规范，如果你觉得有点意思，不妨可以继续往下看。

> @Innei 提到，代码风格相关的东西建议配置一套 ESLint，可是这本规范手册里面不一定只是“约束”了代码风格，还包含了在一些场景下的特殊运用。例如使用图片的场景，应该默认让他保持原比例，而不是被拉伸。

如果你觉得这里面的一些规则并不够合理，那么你可以大胆的和我提出来，也许我会好好思考一番。


## 工具的选择和取舍

### 不使用 Prettier

保罗在这里并不推荐直接使用「Prettier」进行代码的格式化，格式化后的效果可能无法满足你的个人意愿（需要换行区分的地方它去掉了，不需要换行的地方给你换行了）。

> 这是我加入的某技术群群友的视频：[不推荐使用 Prettier](https://www.bilibili.com/video/BV15i4y1D7kw)

保罗也并不喜欢它自动处理的换行格式，他更喜欢根据实际功能将相同类型的参数或方法放在一行，来减少换行。而且过于依赖工具或许并不是一个好的选择。

```jsx
// 格式化前
<DatePicker className="w-full" format="YYYY-MM-DD HH:mm" showTime
  disabledDate={disabledDate} disabledHours={disabledHours}
  minuteStep={15}
/>

// 格式化后
<DatePicker
  className="w-full"
  format="YYYY-MM-DD HH:mm"
  showTime
  disabledDate={disabledDate}
  disabledHours={disabledHours}
  minuteStep={15}
/>
```


### 善用注释和辅助工具

前端为什么现在都在写 TypeScript 了呢？这主要还是其「类型约束」的功能，可以减少很多潜在性的 Bug。编写 TypeScript 类型定义的过程中其实就形成了一本“字典”，可以让编辑器直接识别参数类型，检查参数是否合法。

编写 PHP 项目的时候也可以通过注释的方式来实现约束参数的类型，并且可以在注释中对函数功能进行描述，在编辑器可识别的情况下能大幅度的提高效率。如果直接编写普通注释，你还得新开一个文件才能查阅，就有些不便了。

## 编码习惯

### 抽象判断

后台项目可能存在功能重合或相似的功能和页面，需要根据自我经验判断其可重用性。如果是同一个功能点的创建和编辑页面，大多数表单和功能都可复用的情况下，是完全可以合并成一个页面展示的，这样即便增加字段，也可以降低修改成本。

如果是两个毫不相干的功能点（登录日志、操作日志），它们接口不一致，但展示内容相似，我会选择编写两个页面去展示，因为对接的后端数据库可能不是同一张表，结构有些许差异，后期存在改动的可能性。

### 多写注释

编写大多数的业务场景，都需要一部分的逻辑思维能力，如果某个功能长期没有得到维护，等到你需要迭代的时候发现这里的代码逻辑全部要重新捋一捋，不仅仅是一点时间的消耗，如果代码质量不高，更是对自己的一种折磨。而且在快速完成迭代的过程中总会存在“技术债务”，也就是留坑。

遇到这种情况就只能通过多写注释的方式来改善，这样不仅对自己的代码负责，方便自己的后期维护，也能让同事更快的熟悉上手这块的逻辑。

> 当然这样做的缺点也是有的，提高了你在公司的可替代性，但是这种习惯对于一个开源项目来说，能让更多人理解代码并参与到你的项目中。就算你不写注释，代码一行嵌套好几个三元表达式什么的，能让其他人看到完全发麻，那下一个接手的也很大可能会进行小重构，折磨的是接手的人，又不是老板和公司。都是打工人，相互折磨也没有什么意义不是么

我并不鼓励每一个函数和过程都写大量的注释，如果在熟悉该函数本身用途及整体执行过程的情况下，只需要对部分比较绕的逻辑进行注释补充即可。

### 多做重构

对于大多数新手来说，都没法确保自己初次编写的代码是符合框架或团队标准的，在这种情况下就很容易出现不合理的抽象、架构以及过程。在时间允许的条件下，直接重写部分代码的“性价比”明显不如直接重构更合理。

切换新的技术，升级依赖库，使用语法糖，发现遗留 Bug... 都是重构中无意之间可能解决的问题。如果项目里面已经遇到了大量不应该重复的代码，你就可以开始着手思考解决方案了。

### 预先处理图片和媒体资源

设计师提供的素材类型多且复杂，但我们可以大概归纳为两种类型：

- 矢量图（svg）一般用于图标或插画
- 位图（jpg / png）一般用于背景，插图

矢量图可以使用 [张鑫旭的压缩工具](https://www.zhangxinxu.com/sp/svgo) 压缩一波，然后再插入到项目里面,确保没有冗余代码（空格换行，无效属性和注释字符等）的同时减少存储占用，提高访问效率。

需要透明度的图片才使用 `png` 格式，否则都默认采用 `jpg` 格式，`png` 本身的格式特性会比 `jpg` 占用更大的空间。

图片本身的尺寸也得保证不会过大，在无 PPI 缩放屏幕上实际显示 500 像素的图片，兼顾到像 MacBook 或手机这样的高分屏设备，可以保留到 1000 像素。图片本身也最好使用 [TinyPNG](https://tinypng.com) 一类的压缩工具处理一下。

如果不考虑兼容性，可直接采用 `webp` 格式，无需从 `jpg` 和 `png` 之间做选择。当然如果你使用了 OSS 或 CDN 一类的服务托管图片资源，那就更轻松了，可以自动根据客户端浏览器压缩和替换格式，提升访问速度。

关于图片优化的详情也可参考我的文章：[谈谈 Web 图片浏览体验与优化](https://paugram.com/essay/talking-web-images.html)

#### SVG 图标

可以直接作为一个 ReactElement 存在一个 `.tsx` 文件夹内，将多个图标进行导出，或者使用打包器提取指定目录下的所有 SVG 文件，作为页面全局的一部分，再使用 SVG 的 `use` 标签引用，这种方式也支持使用 `color: currentColor` 进行自定义填色。

```html
<!-- 定义 -->
<svg xmlns="http://www.w3.org/2000/svg" xmlns:link="http://www.w3.org/1999/xlink">
  <symbol fill="none" viewBox="0 0 14 16" id="icon-security-fill">
    <path d="..." stroke="currentColor"></path>
    <path fill-rule="evenodd" clip-rule="evenodd" d="..." fill="currentColor"></path>
  </symbol>
</svg>

<!-- 使用 -->
<svg xmlns="http://www.w3.org/2000/svg" xmlns:link="http://www.w3.org/1999/xlink">
  <use href="#icon-security-fill"></use>
</svg>
```

#### SVG 插画

就是最纯粹的引入就行了，不玩任何套路。记得存放前走一波压缩工具！

```tsx
import homeIllust from "@/images/home/HomeIllust.svg";

...

<img src={homeIllust} alt="Home Illust" />
```

## 参考文章

本文档的部分规范，借鉴了他人经验，感谢他们为我提供了帮助。

- 《[我是如何带领团队从零到一建立前端规范的](https://juejin.cn/post/7085257325165936648)》@不要秃头啊
- 《[编写防御性 CSS 实践](https://zhuanlan.zhihu.com/p/456571205)》@KooFE

## 开源声明

本项目采用 MIT 形式开源，使用了如下技术进行构建：

- VitePress
